<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>JVM</title><link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 40px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 2; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 32px; padding-right: 32px; padding-bottom: 0px; break-after: avoid; }
  .typora-export #write::after { height: 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none 0s ease 0s; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
svg[id^="mermaidChart"] { line-height: 1em; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
mark .md-meta { color: rgb(0, 0, 0); opacity: 0.3 !important; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #c7e6c8;
    --control-text-color: #777;
	background-color: #c7edcc;
}

@include-when-export url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

html {
    font-size: 18px;
}

body {
    font-family: "SimSun","Clear Sans","Helvetica Neue",Helvetica,Arial,sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write{
    max-width: 860px;
  	margin: 0 auto;
  	padding: 20px 30px 40px 30px;
	padding-top: 20px;
    padding-bottom: 100px;
}
#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

body > *:first-child {
    margin-top: 0 !important;
}
body > *:last-child {
    margin-bottom: 0 !important;
}
a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
	color: #4169E1;
}

h1{
	text-align: center;
}

h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    /*background: url("file:///C://Users//Administrator//AppData//Roaming//images/modules/styleguide/para.png") no-repeat 10px center;*/
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    padding-bottom: .3em;
    font-size: 2.25em;
    line-height: 1.2;
}
h2 {
	padding-bottom: .3em;
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #8080ff;
}
h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    padding: 0;
    margin: 16px 0;
    background-color: #afeeee;
    border: 1px dashed;
    overflow: hidden;
    box-sizing: content-box;
}

body > h2:first-child {
    margin-top: 0;
    padding-top: 0;
}
body > h1:first-child {
    margin-top: 0;
    padding-top: 0;
}
body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0;
}
body > h3:first-child,
body > h4:first-child,
body > h5:first-child,
body > h6:first-child {
    margin-top: 0;
    padding-top: 0;
}
a:first-child h1,
a:first-child h2,
a:first-child h3,
a:first-child h4,
a:first-child h5,
a:first-child h6 {
    margin-top: 0;
    padding-top: 0;
}
h1 p,
h2 p,
h3 p,
h4 p,
h5 p,
h6 p {
    margin-top: 0;
}
li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #8080ff;
    padding: 0 15px;
    color: black;
	background-color:#DEB887;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border-top: 1px solid #1591fa;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n) {
    background-color: #D3D3D3;
}
table tr th {
    font-weight: bold;
    border: 1px solid #1598fa;
    text-align: center;
    margin: 0;
    padding: 6px 13px;
	background-color: #87CEFA;
}
table tr td {
    border: 1px solid #1598fa;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}

table tr th:first-child,
table tr td:first-child {
    margin-top: 0;
}
table tr th:last-child,
table tr td:last-child {
    margin-bottom: 0;
}

.CodeMirror-gutters {
    border-right: 1px solid #ddd;
}

.md-fences,
code,
tt {
    border: 1px solid #ddd;
    background-color: #c0c0c0;
    border-radius: 3px;
    padding: 0;
    font-family: Consolas, "Liberation Mono", Courier, monospace;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding: 0.2em 1em;
    padding-top: 8px;
    padding-bottom: 6px;
	border-color:#8080ff;
}
.task-list{
	padding-left: 0;
}

.task-list-item {
	padding-left:32px;
}

.task-list-item input {
  top: 3px;
  left: 8px;
}

@media screen and (min-width: 914px) {
    /*body {
        width: 854px;
        margin: 0 auto;
    }*/
}
@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #AFEEEE;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    border: 1px solid #ddd;
    border-radius: 3px;
    font-family: Consolas, "Liberation Mono", Courier, monospace;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag{
	color: inherit;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

#md-notification:before {
    top: 10px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "SimSun", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}



</style>
</head>
<body class='typora-export os-windows' >
<div  id='write'  class = 'is-node'><p><span>	</span></p><h1><a name="图片" class="md-header-anchor"></a><span>图片</span></h1><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527164423809.png" referrerpolicy="no-referrer" alt="image-20200527164423809"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527154541191.png" referrerpolicy="no-referrer" alt="image-20200527154541191"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527152800106.png" referrerpolicy="no-referrer" alt="image-20200527152800106"></p><p>&nbsp;</p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527154653359.png" referrerpolicy="no-referrer" alt="image-20200527154653359"></p><p>&nbsp;</p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527160420832.png" referrerpolicy="no-referrer" alt="image-20200527160420832"></p><p>&nbsp;</p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527163856026.png" referrerpolicy="no-referrer" alt="image-20200527163856026"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200603211210529.png" referrerpolicy="no-referrer" alt="image-20200603211210529"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604114320985.png" referrerpolicy="no-referrer" alt="image-20200604114320985"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612152249321.png" referrerpolicy="no-referrer" alt="image-20200612152249321"></p><p>&nbsp;</p><h1><a name="一内存与垃圾回收篇" class="md-header-anchor"></a><span>一、内存与垃圾回收篇</span></h1><h2><a name="基本指令" class="md-header-anchor"></a><span>基本指令：</span></h2><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">idea中</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cd</span> <span class="cm-variable">out目录下到</span>.<span class="cm-variable">class目录下</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">执行javap</span> <span class="cm-operator">-</span><span class="cm-variable">v</span> <span class="cm-variable">字节码文件</span>; <span class="cm-variable">javap</span> <span class="cm-operator">-</span><span class="cm-variable">verbose</span> <span class="cm-variable">字节码文件；</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">javap</span> <span class="cm-operator">-</span><span class="cm-variable">v</span> <span class="cm-operator">-</span><span class="cm-variable">p</span> <span class="cm-variable">字节码文件：可以查看私有的</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">javap</span> <span class="cm-operator">-</span><span class="cm-variable">v</span> <span class="cm-operator">-</span><span class="cm-variable">p</span> <span class="cm-variable">字节码文件</span> <span class="cm-operator">-&gt;</span> <span class="cm-variable">text</span>.<span class="cm-variable">txt</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">cmd中</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">执行jps查看运行的进程</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">jstat</span> <span class="cm-operator">-</span><span class="cm-variable">gc</span> <span class="cm-variable">进程号</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">jinfo</span> <span class="cm-operator">-</span><span class="cm-variable">flag</span> <span class="cm-variable">参数</span> <span class="cm-variable">进程号</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">jinfo</span> <span class="cm-operator">-</span><span class="cm-variable">flag</span> <span class="cm-variable">SurvivorRatio</span> <span class="cm-variable">进程id</span> <span class="cm-variable">默认情况下：</span><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">SurvivorRatio</span><span class="cm-operator">=</span><span class="cm-number">8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">jinfo</span> <span class="cm-operator">-</span><span class="cm-variable">flag</span> <span class="cm-variable">NewRation</span> <span class="cm-variable">进程id</span> &nbsp; <span class="cm-variable">默认情况下：</span><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">NewRatio</span><span class="cm-operator">=</span><span class="cm-number">2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">java</span> <span class="cm-operator">-</span><span class="cm-variable">Xint</span> <span class="cm-operator">-</span><span class="cm-variable">version</span> <span class="cm-variable">进入纯解释区的模式</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">java</span> <span class="cm-operator">-</span><span class="cm-variable">Xcomp</span> <span class="cm-operator">-</span><span class="cm-variable">version</span> <span class="cm-variable">进入JIT编译器模式</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">java</span> <span class="cm-operator">-</span><span class="cm-variable">Xmixed</span> <span class="cm-operator">-</span><span class="cm-variable">version</span> <span class="cm-variable">设置混合的模式</span> <span class="cm-variable">也是默认模式</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 406px;"></div><div class="CodeMirror-gutters" style="display: none; height: 406px;"></div></div></div></pre><h2><a name="1jvm的整体结构" class="md-header-anchor"></a><span>1、JVM的整体结构</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527152503806.png" referrerpolicy="no-referrer" alt="image-20200527152503806"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527152800106.png" referrerpolicy="no-referrer" alt="image-20200527152800106"></p><h3><a name="java代码执行流程" class="md-header-anchor"></a><span>java代码执行流程</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527152931231.png" referrerpolicy="no-referrer" alt="image-20200527152931231"></p><h3><a name="jvm的架构模型" class="md-header-anchor"></a><span>JVM的架构模型</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527153005588.png" referrerpolicy="no-referrer" alt="image-20200527153005588"></p><h3><a name="jvm的生命周期" class="md-header-anchor"></a><span>JVM的生命周期：</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527153251406.png" referrerpolicy="no-referrer" alt="image-20200527153251406"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527153938356.png" referrerpolicy="no-referrer" alt="image-20200527153938356"></p><h3><a name="jvm的发展历程" class="md-header-anchor"></a><span>JVM的发展历程</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527154911853.png" referrerpolicy="no-referrer" alt="image-20200527154911853"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527155708204.png" referrerpolicy="no-referrer" alt="image-20200527155708204"></p><h4><a name="三大虚拟机之一" class="md-header-anchor"></a><span>三大虚拟机之一：</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527155938239.png" referrerpolicy="no-referrer" alt="image-20200527155938239"></p><h4><a name="三大虚拟机之二" class="md-header-anchor"></a><span>三大虚拟机之二：</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527160632453.png" referrerpolicy="no-referrer" alt="image-20200527160632453"></p><h4><a name="三大虚拟机之三" class="md-header-anchor"></a><span>三大虚拟机之三：</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527160729842.png" referrerpolicy="no-referrer" alt="image-20200527160729842"></p><p>&nbsp;</p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527161739724.png" referrerpolicy="no-referrer" alt="image-20200527161739724"></p><p>&nbsp;</p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527161858452.png" referrerpolicy="no-referrer" alt="image-20200527161858452"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527161835193.png" referrerpolicy="no-referrer" alt="image-20200527161835193"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527162143247.png" referrerpolicy="no-referrer" alt="image-20200527162143247"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527162408362.png" referrerpolicy="no-referrer" alt="image-20200527162408362"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527162553428.png" referrerpolicy="no-referrer" alt="image-20200527162553428"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527163107690.png" referrerpolicy="no-referrer" alt="image-20200527163107690"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527163434841.png" referrerpolicy="no-referrer" alt="image-20200527163434841"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527163549508.png" referrerpolicy="no-referrer" alt="image-20200527163549508"></p><h2><a name="2类加载子系统loadinglinkinginitialization）" class="md-header-anchor"></a><span>2、类加载子系统（Loading，Linking，Initialization）</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527165555112.png" referrerpolicy="no-referrer" alt="image-20200527165555112"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527165746336.png" referrerpolicy="no-referrer" alt="image-20200527165746336"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527170030780.png" referrerpolicy="no-referrer" alt="image-20200527170030780"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527165809733.png" referrerpolicy="no-referrer" alt="image-20200527165809733"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527170234436.png" referrerpolicy="no-referrer" alt="image-20200527170234436"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527170557573.png" referrerpolicy="no-referrer" alt="image-20200527170557573"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527172236679.png" referrerpolicy="no-referrer" alt="image-20200527172236679"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527172315027.png" referrerpolicy="no-referrer" alt="image-20200527172315027"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rt</span>.<span class="cm-variable">jar：Java基础类库，也就是Java</span> <span class="cm-variable">doc里面看到的所有的类的class文件。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tools</span>.<span class="cm-variable">jar：是系统用来编译一个类的时候用到的，即执行javac的时候用到。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dt</span>.<span class="cm-variable">jar：dt</span>.<span class="cm-variable">jar是关于运行环境的类库，主要是swing包。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 76px;"></div><div class="CodeMirror-gutters" style="display: none; height: 76px;"></div></div></div></pre><h4><a name="类加载器的分类" class="md-header-anchor"></a><span>类加载器的分类：</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527210139265.png" referrerpolicy="no-referrer" alt="image-20200527210139265"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527210245366.png" referrerpolicy="no-referrer" alt="image-20200527210245366"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200527210501360.png" referrerpolicy="no-referrer" alt="image-20200527210501360"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528095514514.png" referrerpolicy="no-referrer" alt="image-20200528095514514"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528100031178.png" referrerpolicy="no-referrer" alt="image-20200528100031178"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528100423586.png" referrerpolicy="no-referrer" alt="image-20200528100423586"></p><p>&nbsp;</p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528101435344.png" referrerpolicy="no-referrer" alt="image-20200528101435344"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528104348566.png" referrerpolicy="no-referrer" alt="image-20200528104348566"></p><h4><a name="双亲委派机制" class="md-header-anchor"></a><span>双亲委派机制</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528111051138.png" referrerpolicy="no-referrer" alt="image-20200528111051138"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528111123681.png" referrerpolicy="no-referrer" alt="image-20200528111123681"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528112554692.png" referrerpolicy="no-referrer" alt="image-20200528112554692"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528113002203.png" referrerpolicy="no-referrer" alt="image-20200528113002203"></p><h4><a name="沙箱安全机制" class="md-header-anchor"></a><span>沙箱安全机制</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528113111213.png" referrerpolicy="no-referrer" alt="image-20200528113111213"></p><h4><a name="其他点" class="md-header-anchor"></a><span>其他点：</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528113519401.png" referrerpolicy="no-referrer" alt="image-20200528113519401"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528113538852.png" referrerpolicy="no-referrer" alt="image-20200528113538852"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528113803946.png" referrerpolicy="no-referrer" alt="image-20200528113803946"></p><h2><a name="3运行时数据区" class="md-header-anchor"></a><span>3、运行时数据区</span></h2><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">内存是非常重要的系统资源，是硬盘和CPU的中间仓库及桥梁，承载着操作系统和应用程序的实时运行。JVM内存布局规定了java在运行过程中内存申请、分配、管理的策略，保证了JVM的高效稳定运行。不同的JVM对于内存的划分方式和管理机制存在着部分差异。结合JVM虚拟机规范，来探讨一下经典的JVM内存布局。</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 101px;"></div><div class="CodeMirror-gutters" style="display: none; height: 101px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528142524707.png" referrerpolicy="no-referrer" alt="image-20200528142524707"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528143252992.png" referrerpolicy="no-referrer" alt="image-20200528143252992"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">每个JVM只有一个Runtime实例。即为运行时环境，相当于内存结构的中间的那个框框：运行时环境。</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 25px;"></div><div class="CodeMirror-gutters" style="display: none; height: 25px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528143612787.png" referrerpolicy="no-referrer" alt="image-20200528143612787"></p><h3><a name="线程" class="md-header-anchor"></a><span>线程：</span></h3><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">线程是一个程序里的运行单元。JVM允许一个应用有多个线程并行的执行。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">在Hotspot</span> <span class="cm-variable">JVM</span> <span class="cm-variable">里，每个线程都与操作系统的本地线程直接映射。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">当一个Java线程准备好执行以后，此时一个操作系统的本地线程也同时创建。Java线程执行终止后，本地线程回收。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">操作系统负责所有线程的安排调度到任何一个可用的CPU上。一旦本地线程初始化成功，它就会调用Java线程中的run（）方法。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 152px;"></div><div class="CodeMirror-gutters" style="display: none; height: 152px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528144717228.png" referrerpolicy="no-referrer" alt="image-20200528144717228"></p><h3><a name="1程序计数器pc寄存器）pc-register" class="md-header-anchor"></a><span>1、程序计数器（PC寄存器）PC Register</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528150038426.png" referrerpolicy="no-referrer" alt="image-20200528150038426"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528150315716.png" referrerpolicy="no-referrer" alt="image-20200528150315716"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">它是一块很小的内存空间，几乎可以忽略不计。也是运行速度最快的存储区域。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">在JVM规范中，每个线程都有它自己的程序计数器，是线程私有的，生命周期与线程的生命周期保持一致。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">任何时间一个线程都只有一个方法在执行，也就是所谓的当前方法。程序计数器会存储当前线程正在执行的Java方法的JVM指令地址；或者，如果是在执行native方法，则是未指定值（undefined）。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">它是程序控制流的指示器</span>,<span class="cm-variable">分支、循环、跳转、异常处理、线程恢复等基础功能都需要依赖这个计数器俩完成。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">字节码解释器工作时就是通过改变这个计数器的值来选取下一条需要执行的字节码指令。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">它是唯一一个在Java虚拟机规范中没有规定任何OutOfMenoryError情况的区域。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 329px;"></div><div class="CodeMirror-gutters" style="display: none; height: 329px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528153109672.png" referrerpolicy="no-referrer" alt="image-20200528153109672"></p><h4><a name="两个常见问题" class="md-header-anchor"></a><span>两个常见问题</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528153354411.png" referrerpolicy="no-referrer" alt="image-20200528153354411"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528153501715.png" referrerpolicy="no-referrer" alt="image-20200528153501715"></p><h4><a name="cup时间片" class="md-header-anchor"></a><span>cup时间片</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200528153934953.png" referrerpolicy="no-referrer" alt="image-20200528153934953"></p><h3><a name="2虚拟机栈" class="md-header-anchor"></a><span>2、虚拟机栈</span></h3><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">虚拟机栈出现的背景：</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">由于跨平台的设计，Java的指令都是根据栈来设计的。不同平台CPU架构不同，所以不能设计为基于寄存器的。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">优点是跨平台，指令集小，编译器容易实现，缺点是性能下降，实现同样的功能需要更多的指令。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 101px;"></div><div class="CodeMirror-gutters" style="display: none; height: 101px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529084214487.png" referrerpolicy="no-referrer" alt="image-20200529084214487"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529085554582.png" referrerpolicy="no-referrer" alt="image-20200529085554582"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529085959807.png" referrerpolicy="no-referrer" alt="image-20200529085959807"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529090312100.png" referrerpolicy="no-referrer" alt="image-20200529090312100"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529091345287.png" referrerpolicy="no-referrer" alt="image-20200529091345287"></p><h4><a name="栈中的存储单位" class="md-header-anchor"></a><span>栈中的存储单位：</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">每个线程都有自己的栈，栈中的数据都是以栈帧（Stack</span> <span class="cm-variable">Frame）的格式存在。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">在这个线程上正在执行的每个方法都各自对应一个栈帧（Stack</span> <span class="cm-variable">Frame）。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">栈帧是一个内存区块，是一个数据集，维系着方法执行过程中的各种数据信息。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 77px;"></div><div class="CodeMirror-gutters" style="display: none; height: 77px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529092226264.png" referrerpolicy="no-referrer" alt="image-20200529092226264"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529092329419.png" referrerpolicy="no-referrer" alt="image-20200529092329419"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529094445604.png" referrerpolicy="no-referrer" alt="image-20200529094445604"></p><h4><a name="栈帧的内部结构" class="md-header-anchor"></a><span>栈帧的内部结构：</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529094614052.png" referrerpolicy="no-referrer" alt="image-20200529094614052"></p><h5><a name="1局部变量表local-variable）" class="md-header-anchor"></a><span>1.局部变量表（local variable）</span></h5><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">局部变量表也被称之为局部变量数组或本地变量表</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">定义为一个数字数组，主要用于存储参数和定义在方法体内的局部变量，这些数据类型包括各类基本数据类型、对象引用（reference），以及returnAddress类型。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">由于局部变量表示建立在线程的栈上，是线程的私有数据，因此不存在数据安全问题。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">局部变量表所需的容量大小是在编译期确定下来的，并保存在方法的Code属性的maximum</span> <span class="cm-variable">local</span> <span class="cm-variable">variables数据项中。在方法运行期间是不会改变局部变量表的大小的。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">方法嵌套调用的次数由栈的大小决定。一般来说，栈越大，方法嵌套调用次数越多。对一个函数而言，他的参数和局部变量越多，使得局部变量表膨胀，它的栈帧就越大，以满足方法调用所需传递的信息增大的需求。进而函数调用就会占用更多的栈空间，导致其嵌套调用次数就会减少。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">局部变量表中的变量只在当前方法调用中有效。在方法执行时，虚拟机通过使用局部变量表完成参数值到参数变量列表的传递过程。当方法调用结束后，随着方法栈帧的销毁，局部变量表也会随之销毁。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 279px;"></div><div class="CodeMirror-gutters" style="display: none; height: 279px;"></div></div></div></pre><p><span>关于Slot的理解</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">参数值的存放总是在局部变量数组的index0开始，到数组长度</span><span class="cm-operator">-</span><span class="cm-number">1</span><span class="cm-variable">的索引结束</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">局部变量表，最基本的存储单元是Slot（变量槽）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">局部变量表中存放编译期可知的各种基本数据类型（8种），引用类型（reference），returnAddress类型的变量。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">在局部变量表里，32位以内的类型只占有一个slot（包括returnAdrress类型），64位的类型（long和double）占用两个slot。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">byte、short、char在存储强被转换为int，boolean也被转换为int，0表示false，非0表示true。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">long和double则占据两个Slot。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 229px;"></div><div class="CodeMirror-gutters" style="display: none; height: 229px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529105605098.png" referrerpolicy="no-referrer" alt="image-20200529105605098"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529110747871.png" referrerpolicy="no-referrer" alt="image-20200529110747871"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529110836543.png" referrerpolicy="no-referrer" alt="image-20200529110836543"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">变量的分类：按照数据类型分：</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">①</span> <span class="cm-variable">基本数据类型</span> &nbsp;<span class="cm-variable">②</span> <span class="cm-variable">引用数据类型</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">按照在类中声明的位置分：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">①</span> <span class="cm-variable">成员变量：在使用前，都经历过默认初始化赋值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">类变量：</span> <span class="cm-variable">linking的prepare阶段：给类变量默认赋值</span> &nbsp;<span class="cm-operator">---&gt;</span> <span class="cm-variable">initial阶段：给类变量显式赋值即静态代码块赋值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">实例变量：随着对象的创建，会在堆空间中分配实例变量空间，并进行默认赋值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">②</span> <span class="cm-variable">局部变量：在使用前，必须要进行显式赋值的！否则，编译不通过</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 204px;"></div><div class="CodeMirror-gutters" style="display: none; height: 204px;"></div></div></div></pre><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">补充说明：</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">在栈帧中，与性能调优关系最为密切的部分就是前面提到的局部变量表。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">在方法执行时，虚拟机使用局部变量表完成方法的传递。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">局部变量表中的变量也是重要的垃圾回收根节点，只有被局部变量表中直接或间接引用的对象都不会被回收。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 127px;"></div><div class="CodeMirror-gutters" style="display: none; height: 127px;"></div></div></div></pre><h5><a name="2操作数栈operand-stack" class="md-header-anchor"></a><span>2.操作数栈（Operand Stack)</span></h5><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java "><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">栈：可以使用数组或链表来实现</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200529113024041.png" referrerpolicy="no-referrer" alt="image-20200529113024041"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200601112203967.png" referrerpolicy="no-referrer" alt="image-20200601112203967"></p><p>&nbsp;</p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200603200408233.png" referrerpolicy="no-referrer" alt="image-20200603200408233"></p><h5><a name="3动态链接dynamic-linking）" class="md-header-anchor"></a><span>3.动态链接（Dynamic Linking）</span></h5><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">动态链接（或指向运行时常量池的方法引用）</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">每一个栈帧内部都包含一个指向运行时常量池中该栈帧所属方法的引用。包含这个引用的目的就是为了支持当前方法的代码能够实现动态链接（Dynamic</span> <span class="cm-variable">Linking）。比如：invokedynamic指令</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">在java源文件被编译到字节码文件中时，所有的变量和方法引用都作为符号引用（Symbolic</span> <span class="cm-variable">Reference）保存在calss文件的常量池里。比如：描述一个方法调用了另外的其他方法时，就是通过常量池中指向方法的符号引用来表示的，那么动态链接的作用就是为了将这些符号引用转换为调用方法的直接引用。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 203px;"></div><div class="CodeMirror-gutters" style="display: none; height: 203px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200603210313075.png" referrerpolicy="no-referrer" alt="image-20200603210313075"></p><h5><a name="4方法返回地址return-address）" class="md-header-anchor"></a><span>4.方法返回地址（Return Address）</span></h5><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">存放调用该方法的pc寄存器的值。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">一个方法的结束，有两种方式：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">正常执行完成</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">出现未处理的异常，非正常退出</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">无论通过哪种方法退出，在方法退出后都返回到该方法被调用的位置。方法正常退出时，调用者的pc计数器的值作为返回地址，即调用该方法的指令的下一条指令的地址。而通过异常退出的，返回地址是要通过异常表来确定，栈帧中一般不会保存这部分信息。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">本质上，方法的退出就是当前栈帧出栈的过程。此时，需要恢复上层方法的局部变量表、操作数栈、将返回值压入调用者栈帧的操作数栈、设置pc寄存器值等，让调用者方法继续执行下去。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">正常完成出口和异常完成出口的区别在于：通过异常完成出口退出的不会给他的上层调用者产生任何的返回值。</span> &nbsp; &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 280px;"></div><div class="CodeMirror-gutters" style="display: none; height: 280px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604101734592.png" referrerpolicy="no-referrer" alt="image-20200604101734592"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604102116120.png" referrerpolicy="no-referrer" alt="image-20200604102116120"></p><p>&nbsp;</p><p><span>为什么需要使用常量池</span></p><p><span>常量池的作用，就是为了提供一些符号和常量，便于指令的识别。</span></p><h4><a name="栈顶缓存top-of-stack-cashing技术" class="md-header-anchor"></a><span>栈顶缓存（Top-of-Stack-Cashing)技术</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">前面提过，基于栈式架构的虚拟机所使用的零地址指令更加紧凑，但完成一项操作的时候必须需要使用更多的入栈和出栈指令，这同时也就意味着将需要更多的指令分派（instruction</span> <span class="cm-variable">dispatch）次数和内存读</span><span class="cm-operator">/</span><span class="cm-variable">写次数。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">由于操作数是存储在内存中的，因此频繁地执行内存读</span><span class="cm-operator">/</span><span class="cm-variable">写操作必须会影响执行速度。为了解决这个问题，HotSpot</span> <span class="cm-variable">JVM</span> <span class="cm-variable">的设计者们提出了栈顶缓存技术，将栈顶元素全部缓存在物理cup的寄存器中，以此降低对内存的读</span><span class="cm-operator">/</span><span class="cm-variable">写次数，提升执行引擎的执行效率。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 178px;"></div><div class="CodeMirror-gutters" style="display: none; height: 178px;"></div></div></div></pre><h4><a name="方法的调用" class="md-header-anchor"></a><span>方法的调用</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">在JVM中，将符号引用转换为调用方法的直接引用与方法的绑定机制相关。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">静态链接：当一个字节码文件被装载进JVM内部时，如果被调用的目标方法在编译期可知，且运行期保持不变时。这种情况下将调用方法的符号引用转换为直接引用的过程称之为静态链接。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">动态链接：如果被调用的方法在编译期无法被确定下来，也就是说，只能够在程序运行期将调用方法的符号引用转换为直接引用，由于这种引用转换过程具备动态性，因此也就被称之为动态链接。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">对应的方法的绑定机制为：早期绑定（Early</span> <span class="cm-variable">Binding</span>)<span class="cm-variable">和晚期绑定（Late</span> <span class="cm-variable">Binding</span>)<span class="cm-variable">。绑定是一个字段、方法或者类在符号引用被替换为直接引用的过程，这仅仅发生一次。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">早期绑定：早期绑定就是指被调用的目标方法如果在编译期可知，且运行期保持不变时，即可将这个方法与所属的类型进行绑定，这样一来，由于明确了呗调用的目标方法究竟是那一个，因此也就可以使用静态链接的方式将符号引用转换为直接引用。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">晚期绑定：如果被调用的方法在编译期无法被确定下来，只能够在程序运行期根据实际的类型绑定相关的方法，这种绑定方式也就被称之为晚期绑定。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 382px;"></div><div class="CodeMirror-gutters" style="display: none; height: 382px;"></div></div></div></pre><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">随着高级语言的横空出世，类似于java一样的基于面向对象的编程语言如今越来越多，尽管这类编程语言在语言风格上存在一定的差别，但是它们彼此之间始终保持着一个共性，那就是都支持封装、继承和多态等面向对象特性，既然这一类的编程语言具备多态特性，那么自然也就具备早期绑定和晚期绑定两种绑定方式。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">java中任何一个普通的方法其实都具备虚函数的特征，他们相当于C</span><span class="cm-operator">++</span><span class="cm-variable">语言中的虚函数（C</span><span class="cm-operator">++</span><span class="cm-variable">中则需要使用关键字virtual来显示定义）。如果在java程序中不希望某个方法拥有虚函数的特征时，则可以使用关键字final来标记这个方法。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 178px;"></div><div class="CodeMirror-gutters" style="display: none; height: 178px;"></div></div></div></pre><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">方法的调用：虚方法与非虚方法</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">非虚方法：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">如果方法在编译期就确定了具体的调用版本，这个版本在运行时时不可变的。这样的方法称为非虚方法。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">静态方法、私有方法、final方法、实例构造器、父类方法都是非虚方法。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">其他方法称为虚方法。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 153px;"></div><div class="CodeMirror-gutters" style="display: none; height: 153px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604085945707.png" referrerpolicy="no-referrer" alt="image-20200604085945707"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">关于invokedynamic指令</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">JVM字节码指令集一直比较稳定，一直到java7中才增加了一个invokedynamic指令，这是java为了实现动态类型语言支持而做的一种改进。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">但是在java7中并没有提供直接生成invokedynamic指令的方法，需要借助ASM这种底层字节码工具来产生invokedynamic指令。直到java8的Lambda表达式的出现，invokedynamic指令的生成，在java中才有了直接的生成方式。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">java7中增加的动态语言类型支持的本质是对java虚拟机规范的修改，而不是对java语言规则的修改，这个一块相对来讲比较复杂，增加了虚拟机中方法调用，最直接的受益者就是运行在java平台的动态语言的编译器。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 228px;"></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></pre><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">动态类型语言和静态类型语言</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">动态类型语言和静态类型语言两者的区别就在于对类型的检查是在编译期还是在运行期，满足前者就是静态类型语言，反之是动态类型语言。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">说的再直白一点就是，静态类型语言是判断变量自身的类型信息；动态类型语言是判断变量值得类型信息，变量没有类型信息，变量值才有类型信息，这是动态语言的一个重要特性。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 127px;"></div><div class="CodeMirror-gutters" style="display: none; height: 127px;"></div></div></div></pre><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">方法的调用：方法重写的本质</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">java语言中方法重写的本质：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">1</span><span class="cm-variable">、找到操作数栈顶的第一个元素所执行的对象的实际类型，记作C。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">2</span><span class="cm-variable">、如果在过程结束；如果不通类型C中找到与常量中的描述符合简单名称都相符的方法，则进行访问权限校验，如果通过则放回这个方法的直接引用，查找过，则返回java</span>.<span class="cm-variable">lang</span>.<span class="cm-variable">IllegalAccessError异常。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">3</span><span class="cm-variable">、否则，按照继承关系从下往上依次对C的各个父类进行第2步的搜索和验证过程。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">4</span><span class="cm-variable">、如果始终没有找到合适的方法，则抛出java</span>.<span class="cm-variable">lang</span>.<span class="cm-variable">AbstractMethodError异常。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">IllegalAccessError介绍：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">程序试图访问或修改一个属性或调用一个方法，这个属性或方法，你没有权限访问。一般的，这个会引起编译器异常。这个错误如果发生在运行时，就说明一个类发生了不兼容的改变。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 281px;"></div><div class="CodeMirror-gutters" style="display: none; height: 281px;"></div></div></div></pre><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">方法的调用：虚方法表</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">在面向对象的编程中，会很频繁的使用到动态分派，如果在每次动态分派的过程中都要重新再累的方法元数据中搜索合适的目标的话就可能影响到执行效率。因此，为了提高性能，JVM采用在类的方法区建立一个虚方法表</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">（virtual</span> <span class="cm-variable">method</span> <span class="cm-variable">table</span>)(<span class="cm-variable">非虚方法不会出现在表中</span>)<span class="cm-variable">来实现。使用索引表来替代查找。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">每个类中都有一个虚方法表，表中存放着各个方法的实际入口。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">那么虚方法表什么时候被创建？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">虚方法表会在类加载的链接阶段被创建并开始初始化，类的变量初始值准备完成之后，JVM会把该类的方法表也初始化完毕。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 229px;"></div><div class="CodeMirror-gutters" style="display: none; height: 229px;"></div></div></div></pre><h3><a name="3本地方法栈native-method-stack）" class="md-header-anchor"></a><span>3、本地方法栈（Native Method Stack）</span></h3><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">java虚拟机栈用于管理java方法的调用，而本地方法栈用于管理本地方法的调用。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">本地方法栈，也是线程私有的。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">允许被实现成固定或者是可动态扩展的内存大小。（在内存溢出方面是相同的）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">如果线程请求分配的栈容量超过本地方法栈允许的最大容量，java虚拟机将会抛出一个StackOverflowError异常。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">如果本地方法栈可以动态扩展，并且在尝试扩展的时候无法申请到足够的内存，或者在创建新的线程时没有足够的内存去创建对象的本地方法栈，那么java虚拟机将会抛出一个OutOfMemoryError异常。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">本地方法是使用c语言实现的。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">它的具体做法是Native</span> <span class="cm-variable">Method</span> <span class="cm-variable">Stack中登记native方法，在Execution</span> <span class="cm-variable">Engine执行时加载本地方法库。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 279px;"></div><div class="CodeMirror-gutters" style="display: none; height: 279px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604113128170.png" referrerpolicy="no-referrer" alt="image-20200604113128170"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">当某个线程调用一个本地方法时，它就进入了一个全新的并且不再受虚拟机限制的世界。它和虚拟机拥有同样的权限。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">本地方法可以通过本地方法接口来访问虚拟机内部的运行时数据区。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">它甚至可以直接使用本地处理器中的寄存器。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">直接从本地内存的堆中分配任意数量的内存。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">并不是所有的JVM都支持本地方法。因为java虚拟机规范并没有明确要求本地方法栈的使用语言、具体实现方式、数据结构等。如果JVM产品不打算支持native方法，也可以无需实现本地方法栈。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">在Hotspot</span> <span class="cm-variable">JVM</span> <span class="cm-variable">中，直接将本地方法栈和虚拟机栈合二为一。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 203px;"></div><div class="CodeMirror-gutters" style="display: none; height: 203px;"></div></div></div></pre><h3><a name="4堆" class="md-header-anchor"></a><span>4、堆  </span></h3><p><span>代码chapter08</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">堆的核心概述：</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">一个JVM实例只存在一个堆内存，堆也是java内存管理的核心区域。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">java堆区在JVM启动的时候即被创建，其空间大小也就确定了。是JVM管理的最大一块内存空间。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">堆内存的大小是可以调节的。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">《java虚拟机规范》规定，堆可以处于物理上不连续的内存空间中，但在逻辑上它应该被视为连续的。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">所有的线程共享java堆，在这里还可以划分线程私有的缓冲区（Thread</span> <span class="cm-variable">Local</span> <span class="cm-variable">Allocation</span> <span class="cm-variable">Buffer，TLAB）。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">《java虚拟机规范》中对java堆的描述是：所有的对象实例以及数组都应当在运行时分配在堆上。（The</span> <span class="cm-variable">heap</span> <span class="cm-variable">is</span> <span class="cm-variable">the</span> <span class="cm-variable">run</span><span class="cm-operator">-</span><span class="cm-variable">time</span> <span class="cm-variable">data</span> <span class="cm-variable">area</span> <span class="cm-variable">from</span> <span class="cm-variable">which</span> <span class="cm-variable">memory</span> <span class="cm-keyword">for</span> <span class="cm-variable">all</span> <span class="cm-keyword">class</span> <span class="cm-def">instances</span> <span class="cm-def">and</span> <span class="cm-def">arrays</span> <span class="cm-def">is</span> <span class="cm-def">allocated</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">我要说的是：“几乎”所有的对象实例都在这里分配内存。——从实际使用角度看的。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">数组和对象可能永远不会存储在栈上，因为栈帧中保存引用，这个引用指向对象或者数组在堆中的位置。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">在方法结束后，堆中的对象不会马上被移除，仅仅在垃圾收集的时候才会被移除。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">堆，是GC（Garbage</span> <span class="cm-variable">Collection，垃圾收集器）执行垃圾回收的重点区域。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 431px;"></div><div class="CodeMirror-gutters" style="display: none; height: 431px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604141010148.png" referrerpolicy="no-referrer" alt="image-20200604141010148"></p><h4><a name="内存核心细分" class="md-header-anchor"></a><span>内存核心：细分</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604141725339.png" referrerpolicy="no-referrer" alt="image-20200604141725339"></p><h4><a name="设置堆空间大小参数设置" class="md-header-anchor"></a><span>设置堆空间大小参数设置</span></h4><p><span>-Xms10m -Xmx10m -XX:+PrintGCDetails 初始内存10兆，最大内存10兆，打印</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">PSYoungGen（</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">eden</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">from</span> &nbsp;<span class="cm-variable">to）</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">ParOldGen</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">jdk7</span>: &nbsp; <span class="cm-variable">PsPermGen</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">jdk8</span>:<span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">Metaspace</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">1.</span> <span class="cm-variable">设置堆空间大小的参数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp; &nbsp; <span class="cm-operator">-</span><span class="cm-variable">Xms</span> <span class="cm-variable">用来设置堆空间（年轻代</span><span class="cm-operator">+</span><span class="cm-variable">老年代</span>)<span class="cm-variable">的初始内存大小</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">-</span><span class="cm-variable">X</span> <span class="cm-variable">是jvm的运行参数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">ms</span> <span class="cm-variable">是memory</span> <span class="cm-variable">start</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp; &nbsp; <span class="cm-operator">-</span><span class="cm-variable">Xmx</span> <span class="cm-variable">用来设置堆空间（年轻代</span><span class="cm-operator">+</span><span class="cm-variable">老年代）的最大内存大小</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">2.</span> <span class="cm-variable">默认堆空间的大小</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp;<span class="cm-variable">初始内存大小：物理电脑内存大小</span> <span class="cm-operator">/</span> <span class="cm-number">64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">最大内存大小：物理电脑内存大小</span> <span class="cm-operator">/</span> <span class="cm-number">4</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-number">3.</span> <span class="cm-variable">手动设置：</span><span class="cm-operator">-</span><span class="cm-variable">Xms600m</span> <span class="cm-operator">-</span><span class="cm-variable">Xmx600m</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp; <span class="cm-variable">开发中建议将初始堆内存和最大的堆内存设置成相同的值。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-number">4.</span> <span class="cm-variable">查看设置的参数：方式一：</span> <span class="cm-variable">jps</span> &nbsp; <span class="cm-operator">/</span> &nbsp;<span class="cm-variable">jstat</span> <span class="cm-operator">-</span><span class="cm-variable">gc</span> <span class="cm-variable">进程id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">方式二：</span><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintGCDetails</span> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">jps查看运行的进程</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">jstat</span> <span class="cm-operator">-</span><span class="cm-variable">gc</span> <span class="cm-variable">进程号</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">jinfo</span> <span class="cm-operator">-</span><span class="cm-variable">flag</span> <span class="cm-variable">SurvivorRatio</span> <span class="cm-variable">进程id</span> <span class="cm-variable">默认情况下：</span><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">SurvivorRatio</span><span class="cm-operator">=</span><span class="cm-number">8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">jinfo</span> <span class="cm-operator">-</span><span class="cm-variable">flag</span> <span class="cm-variable">NewRatio</span> <span class="cm-variable">进程id</span> &nbsp; <span class="cm-variable">默认情况下：</span><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">NewRatio</span><span class="cm-operator">=</span><span class="cm-number">2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">新生代与老年代</span> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">NewRatio</span> <span class="cm-variable">：</span> <span class="cm-variable">设置新生代与老年代的比例。默认值是2</span>.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">SurvivorRatio</span> <span class="cm-variable">：设置新生代中Eden区与Survivor区的比例。默认值是8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">-</span><span class="cm-variable">UseAdaptiveSizePolicy</span> <span class="cm-variable">：关闭自适应的内存分配策略</span> &nbsp;<span class="cm-variable">（暂时用不到）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">Xmn</span>:<span class="cm-variable">设置新生代的空间的大小。</span> <span class="cm-variable">（一般不设置）</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 713px;"></div><div class="CodeMirror-gutters" style="display: none; height: 713px;"></div></div></div></pre><p><span>对空间大小的设置</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">java堆区用于存储java对象实例，那么堆的大小在JVM启动时就已经设定好了，大家可以通过选项</span><span class="cm-string">"-Xmx"</span><span class="cm-variable">和</span><span class="cm-string">"-Xms"</span><span class="cm-variable">来进行设置。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"-Xms"</span><span class="cm-variable">用于表示堆区的起始内存，等价于</span><span class="cm-operator">-</span><span class="cm-variable">XX：InitialHeapSize</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"-Xmx"</span><span class="cm-variable">则用于表示堆区的最大内存，等价于</span><span class="cm-operator">-</span><span class="cm-variable">XX：MaxHeapSize</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">一旦堆区中的内存大小超过</span><span class="cm-string">"-Xmx"</span><span class="cm-variable">所指定的最大内存时，将会抛出OutOfMemoryError异常。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">通常会将</span> <span class="cm-operator">-</span><span class="cm-variable">Xms</span> <span class="cm-variable">和</span> <span class="cm-operator">-</span><span class="cm-variable">Xmx两个参数配置相同的值，其目的是为了能够在java垃圾回收机制清理完堆区后不需要重写分割计算堆区的大小，从而提高性能。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">默认情况下，初始化内存大小：物理电脑内存大小</span> <span class="cm-operator">/</span> <span class="cm-number">64</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span> &nbsp;<span class="cm-variable">最大内存大小：物理电脑内存大小</span> <span class="cm-operator">/</span> <span class="cm-number">4</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 229px;"></div><div class="CodeMirror-gutters" style="display: none; height: 229px;"></div></div></div></pre><h4><a name="年轻代与老年代" class="md-header-anchor"></a><span>年轻代与老年代</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604152702678.png" referrerpolicy="no-referrer" alt="image-20200604152702678"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604153014565.png" referrerpolicy="no-referrer" alt="image-20200604153014565"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604154333402.png" referrerpolicy="no-referrer" alt="image-20200604154333402"></p><h4><a name="对象分配过程" class="md-header-anchor"></a><span>对象分配过程</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604155142639.png" referrerpolicy="no-referrer" alt="image-20200604155142639"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604160643738.png" referrerpolicy="no-referrer" alt="image-20200604160643738"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604160224989.png" referrerpolicy="no-referrer" alt="image-20200604160224989"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604160559861.png" referrerpolicy="no-referrer" alt="image-20200604160559861"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604160050953.png" referrerpolicy="no-referrer" alt="image-20200604160050953"></p><p><strong><span>总结：针对幸存者s0,s1区的总结：复制之后有交换，谁空谁是to.</span></strong></p><p><strong><span>关于垃圾回收：频繁在新生代收集，很少在养老区收集，几乎不在永久区/元空间收集。</span></strong></p><h4><a name="image-20200604161755334dprogram-filestyporamytyporaimagejvmimage-20200604161755334png常用调优工具" class="md-header-anchor"></a><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604161755334.png" referrerpolicy="no-referrer" alt="image-20200604161755334"><span>常用调优工具</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604162446979.png" referrerpolicy="no-referrer" alt="image-20200604162446979"></p><h4><a name="minor-gcmajor-gc与full-gc" class="md-header-anchor"></a><span>Minor GC、Major GC与Full GC</span><span>	</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 25px;"></div><div class="CodeMirror-gutters" style="display: none; height: 25px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604165415747.png" referrerpolicy="no-referrer" alt="image-20200604165415747"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604165722282.png" referrerpolicy="no-referrer" alt="image-20200604165722282"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604170034282.png" referrerpolicy="no-referrer" alt="image-20200604170034282"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604170315400.png" referrerpolicy="no-referrer" alt="image-20200604170315400"></p><h4><a name="堆空间分代思想" class="md-header-anchor"></a><span>堆空间分代思想</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604171338397.png" referrerpolicy="no-referrer" alt="image-20200604171338397"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604171412693.png" referrerpolicy="no-referrer" alt="image-20200604171412693"></p><h4><a name="内存分配策略" class="md-header-anchor"></a><span>内存分配策略</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">内存分配策略（或对象提升（Promotion）规则）</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">如果对象在Eden出生并经过第一次minorGC后仍然存活，并且能被Survivor容纳的话，将被移动到Survivor空间中，并将对象年龄设置为1。对象在Survivor区中每熬过一次MinorGC，年龄就增加1岁，当它的年龄增加到一定程度（默认为15岁，其实每个JVM、每个GC都有所不同）时，就会被晋升到老年代中。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">对象晋升老年代的年龄阈值，可以通过选项</span> <span class="cm-operator">-</span><span class="cm-variable">XX：MaxTenuringThreshold来设置。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 177px;"></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604173134576.png" referrerpolicy="no-referrer" alt="image-20200604173134576"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605112800801.png" referrerpolicy="no-referrer" alt="image-20200605112800801"></p><h4><a name="对象分配过程tlab" class="md-header-anchor"></a><span>对象分配过程：TLAB</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">为什么有TLAB（Thread</span> <span class="cm-variable">Local</span> <span class="cm-variable">Allocation</span> <span class="cm-variable">Buffer）？</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">堆区是线程共享区域，任何线程都可以访问到堆区中的共享数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">由于对象实例的创建在JVM中非常频繁，因此在并发环境下从堆区中划分内存空间是线程不安全的。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">为避免多个线程操作同一地址，需要使用加锁等机制，进而影响分配速度。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 101px;"></div><div class="CodeMirror-gutters" style="display: none; height: 101px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605105700300.png" referrerpolicy="no-referrer" alt="image-20200605105700300"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605105817715.png" referrerpolicy="no-referrer" alt="image-20200605105817715"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605105940735.png" referrerpolicy="no-referrer" alt="image-20200605105940735"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605110136772.png" referrerpolicy="no-referrer" alt="image-20200605110136772"></p><h4><a name="堆空间的参数设置" class="md-header-anchor"></a><span>堆空间的参数设置</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">官方说明：</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">https</span>:<span class="cm-comment">//docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-variable">测试堆空间常用的jvm参数：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintFlagsInitial</span> : <span class="cm-variable">查看所有的参数的默认初始值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintFlagsFinal</span> &nbsp;<span class="cm-variable">：查看所有的参数的最终值（可能会存在修改，不再是初始值）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">具体查看某个参数的指令：</span> <span class="cm-variable">jps：查看当前运行中的进程</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">jinfo</span> <span class="cm-operator">-</span><span class="cm-variable">flag</span> <span class="cm-variable">SurvivorRatio</span> <span class="cm-variable">进程id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">Xms：初始堆空间内存</span> <span class="cm-variable">（默认为物理内存的1</span><span class="cm-operator">/</span><span class="cm-number">64</span><span class="cm-variable">）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">Xmx：最大堆空间内存（默认为物理内存的1</span><span class="cm-operator">/</span><span class="cm-number">4</span><span class="cm-variable">）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">Xmn：设置新生代的大小。</span>(<span class="cm-variable">初始值及最大值</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">NewRatio：配置新生代与老年代在堆结构的占比</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">SurvivorRatio：设置新生代中Eden和S0</span><span class="cm-operator">/</span><span class="cm-variable">S1空间的比例</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">MaxTenuringThreshold：设置新生代垃圾的最大年龄</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintGCDetails：输出详细的GC处理日志</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-variable">打印gc简要信息：①</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintGC</span> &nbsp; <span class="cm-variable">②</span> <span class="cm-operator">-</span><span class="cm-variable">verbose</span>:<span class="cm-variable">gc</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">HandlePromotionFailure：是否设置空间分配担保</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">NewRatio</span> <span class="cm-variable">：</span> <span class="cm-variable">设置新生代与老年代的比例。默认值是2</span>.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">SurvivorRatio</span> <span class="cm-variable">：设置新生代中Eden区与Survivor区的比例。默认值是8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">-</span><span class="cm-variable">UseAdaptiveSizePolicy</span> <span class="cm-variable">：关闭自适应的内存分配策略</span> &nbsp;<span class="cm-variable">（暂时用不到）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-variable">Xmn</span>:<span class="cm-variable">设置新生代的空间的大小。</span> <span class="cm-variable">（一般不设置）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">内存逃逸：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">栈上分配：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">启用逃逸分析：</span><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">DoEscapeAnalysis</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">标量替换参数设置：参数</span><span class="cm-operator">-</span><span class="cm-variable">XX：</span><span class="cm-operator">+</span><span class="cm-variable">EliminateAllocations</span>:<span class="cm-variable">开启了标量替换（默认打开），允许将对象打散分配在栈上。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 735px;"></div><div class="CodeMirror-gutters" style="display: none; height: 735px;"></div></div></div></pre><h4><a name="堆是分配对象存储的唯一选择吗" class="md-header-anchor"></a><span>堆是分配对象存储的唯一选择吗？</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">结论：开发中能使用局部变量的，就不要使用在方法外定义。</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 25px;"></div><div class="CodeMirror-gutters" style="display: none; height: 25px;"></div></div></div></pre><h5><a name="逃逸分析" class="md-header-anchor"></a><span>逃逸分析</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605130801016.png" referrerpolicy="no-referrer" alt="image-20200605130801016"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605130920693.png" referrerpolicy="no-referrer" alt="image-20200605130920693"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605131119399.png" referrerpolicy="no-referrer" alt="image-20200605131119399"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605131220968.png" referrerpolicy="no-referrer" alt="image-20200605131220968"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605131307155.png" referrerpolicy="no-referrer" alt="image-20200605131307155"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605131349611.png" referrerpolicy="no-referrer" alt="image-20200605131349611"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605131438083.png" referrerpolicy="no-referrer" alt="image-20200605131438083"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605131508780.png" referrerpolicy="no-referrer" alt="image-20200605131508780"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605132451604.png" referrerpolicy="no-referrer" alt="image-20200605132451604"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605132650722.png" referrerpolicy="no-referrer" alt="image-20200605132650722"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605132819534.png" referrerpolicy="no-referrer" alt="image-20200605132819534"></p><h3><a name="5方法区jdk8元空间）" class="md-header-anchor"></a><span>5、方法区（jdk8元空间）</span></h3><p><span>代码chapter09</span></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605132951432.png" referrerpolicy="no-referrer" alt="image-20200605132951432"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605133103278.png" referrerpolicy="no-referrer" alt="image-20200605133103278"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605133202031.png" referrerpolicy="no-referrer" alt="image-20200605133202031"></p><p><span>	</span><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605134010267.png" referrerpolicy="no-referrer" alt="image-20200605134010267"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605134822176.png" referrerpolicy="no-referrer" alt="image-20200605134822176"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605134952667.png" referrerpolicy="no-referrer" alt="image-20200605134952667"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605135236908.png" referrerpolicy="no-referrer" alt="image-20200605135236908"></p><h4><a name="设置方法区大小与oom" class="md-header-anchor"></a><span>设置方法区大小与OOM</span></h4><h5><a name="jdk7" class="md-header-anchor"></a><span>jdk7</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605135522798.png" referrerpolicy="no-referrer" alt="image-20200605135522798"></p><h5><a name="jdk8" class="md-header-anchor"></a><span>jdk8</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605141057711.png" referrerpolicy="no-referrer" alt="image-20200605141057711"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-variable">测试设置方法区大小参数的默认值</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-variable">jdk7及以前：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">PermSize</span><span class="cm-operator">=</span><span class="cm-number">100</span><span class="cm-variable">m</span> <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">MaxPermSize</span><span class="cm-operator">=</span><span class="cm-number">100</span><span class="cm-variable">m</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-variable">jdk8及以后：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">MetaspaceSize</span><span class="cm-operator">=</span><span class="cm-number">100</span><span class="cm-variable">m</span> &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">MaxMetaspaceSize</span><span class="cm-operator">=</span><span class="cm-number">100</span><span class="cm-variable">m</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 177px;"></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></pre><h5><a name="如何解决oom" class="md-header-anchor"></a><span>如何解决OOM？</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605141724041.png" referrerpolicy="no-referrer" alt="image-20200605141724041"></p><h4><a name="方法区的内部结构" class="md-header-anchor"></a><span>方法区的内部结构</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605142303356.png" referrerpolicy="no-referrer" alt="image-20200605142303356"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605142518732.png" referrerpolicy="no-referrer" alt="image-20200605142518732"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605142757069.png" referrerpolicy="no-referrer" alt="image-20200605142757069"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605142845372.png" referrerpolicy="no-referrer" alt="image-20200605142845372"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605142938611.png" referrerpolicy="no-referrer" alt="image-20200605142938611"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605144252422.png" referrerpolicy="no-referrer" alt="image-20200605144252422"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605144334445.png" referrerpolicy="no-referrer" alt="image-20200605144334445"></p><h5><a name="常量池" class="md-header-anchor"></a><span>常量池</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605164511421.png" referrerpolicy="no-referrer" alt="image-20200605164511421"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605164711431.png" referrerpolicy="no-referrer" alt="image-20200605164711431"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605165615685.png" referrerpolicy="no-referrer" alt="image-20200605165615685"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605170434799.png" referrerpolicy="no-referrer" alt="image-20200605170434799"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605170613583.png" referrerpolicy="no-referrer" alt="image-20200605170613583"></p><h5><a name="运行时常量池" class="md-header-anchor"></a><span>运行时常量池</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605171038645.png" referrerpolicy="no-referrer" alt="image-20200605171038645"></p><h5><a name="方法区的演进细节" class="md-header-anchor"></a><span>方法区的演进细节</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605173103280.png" referrerpolicy="no-referrer" alt="image-20200605173103280"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605173241436.png" referrerpolicy="no-referrer" alt="image-20200605173241436"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605173325698.png" referrerpolicy="no-referrer" alt="image-20200605173325698"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605173421391.png" referrerpolicy="no-referrer" alt="image-20200605173421391"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605174421326.png" referrerpolicy="no-referrer" alt="image-20200605174421326"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605175342750.png" referrerpolicy="no-referrer" alt="image-20200605175342750"></p><h5><a name="静态变量的调整测试" class="md-header-anchor"></a><span>静态变量的调整测试</span></h5><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* 结论：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* 静态引用对应的对象实体始终都存在堆空间</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">而上图jdk6，jdk7，jdk8 对比 存放的是静态引用</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* jdk7：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* -Xms200m -Xmx200m -XX:PermSize=300m -XX:MaxPermSize=300m -XX:+PrintGCDetails</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* jdk 8：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* -Xms200m -Xmx200m -XX:MetaspaceSize=300m -XX:MaxMetaspaceSize=300m -XX:+PrintGCDetails</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* @author shkstart  shkstart@126.com</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* @create 2020  21:20</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">StaticFieldTest</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">byte</span>[] <span class="cm-variable">arr</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable-3">byte</span>[<span class="cm-number">1024</span> <span class="cm-operator">*</span> <span class="cm-number">1024</span> <span class="cm-operator">*</span> <span class="cm-number">100</span>];<span class="cm-comment">//100MB</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">void</span> <span class="cm-variable">main</span>(<span class="cm-variable-3">String</span>[] <span class="cm-variable">args</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">StaticFieldTest</span>.<span class="cm-variable">arr</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// &nbsp; &nbsp; &nbsp;  try {</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Thread.sleep(1000000);</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// &nbsp; &nbsp; &nbsp;  } catch (InterruptedException e) {</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  e.printStackTrace();</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// &nbsp; &nbsp; &nbsp;  }</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 659px;"></div><div class="CodeMirror-gutters" style="display: none; height: 659px;"></div></div></div></pre><p><span>案例：</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* 《深入理解Java虚拟机》中的案例：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* staticObj、instanceObj、localObj存放在哪里？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* @author shkstart  shkstart@126.com</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* @create 2020  11:39</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">StaticObjTest</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">static</span> <span class="cm-keyword">class</span> <span class="cm-def">Test</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">static</span> <span class="cm-variable">ObjectHolder</span> <span class="cm-variable">staticObj</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ObjectHolder</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">ObjectHolder</span> <span class="cm-variable">instanceObj</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ObjectHolder</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">void</span> <span class="cm-variable">foo</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">ObjectHolder</span> <span class="cm-variable">localObj</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ObjectHolder</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-string">"done"</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">static</span> <span class="cm-keyword">class</span> <span class="cm-def">ObjectHolder</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">void</span> <span class="cm-variable">main</span>(<span class="cm-variable-3">String</span>[] <span class="cm-variable">args</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Test</span> <span class="cm-variable">test</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">StaticObjTest</span>.<span class="cm-variable">Test</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">test</span>.<span class="cm-variable">foo</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 633px;"></div><div class="CodeMirror-gutters" style="display: none; height: 633px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605180943546.png" referrerpolicy="no-referrer" alt="image-20200605180943546"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605181046466.png" referrerpolicy="no-referrer" alt="image-20200605181046466"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605180733700.png" referrerpolicy="no-referrer" alt="image-20200605180733700"></p><h4><a name="方法区的垃圾回收" class="md-header-anchor"></a><span>方法区的垃圾回收</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605182305109.png" referrerpolicy="no-referrer" alt="image-20200605182305109"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605182406996.png" referrerpolicy="no-referrer" alt="image-20200605182406996"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605182727588.png" referrerpolicy="no-referrer" alt="image-20200605182727588"></p><h4><a name="总结" class="md-header-anchor"></a><span>总结：</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605183100788.png" referrerpolicy="no-referrer" alt="image-20200605183100788"></p><p>&nbsp;</p><p>&nbsp;</p><h2><a name="4执行引擎" class="md-header-anchor"></a><span>4、执行引擎</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610173602344.png" referrerpolicy="no-referrer" alt="image-20200610173602344"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">执行引擎是Java虚拟机核心的组成部分之一。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"虚拟机"</span><span class="cm-variable">是一个相对于</span><span class="cm-string">"物理机"</span><span class="cm-variable">的概念，这两种机器都有代码执行能力，其区别是物理机的执行引擎是直接建立在处理器、缓存、指令集合操作系统层面上的，而虚拟机的执行引擎则是由软件自行实现的，因此可以不受物理条件制约地定制指令集与执行引擎的结构体系，能够执行那些不被硬件直接支持的指令集格式。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">JVM的主要任务是负责装载字节码到其内部，但字节码并不能够直接运行在操作系统之上，因为字节码指令并非等价于本地机器指令，它内部包含的仅仅只是一些能够被JVM所识别的字节码指令、符号表，以及其他辅助信息。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">那么，如果想要让一个Java程序运行起来，执行引擎（Execution</span> <span class="cm-variable">Engine</span>)<span class="cm-variable">的任务就是将字节码指令解释</span><span class="cm-operator">/</span><span class="cm-variable">编译为对应平台上的本地机器指令才可以。简单来说，JVM中执行引擎充当了将高级语言翻译为机器语言的译者。</span> &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">从外观上来看，所有的Java虚拟机的执行引擎输入、输出都是一致的：输入的是字节码二进制流，处理过程是字节码解释执行的等效过程，输出的是执行结果。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 330px;"></div><div class="CodeMirror-gutters" style="display: none; height: 330px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610171530080.png" referrerpolicy="no-referrer" alt="image-20200610171530080"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610171735613.png" referrerpolicy="no-referrer" alt="image-20200610171735613"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610171822381.png" referrerpolicy="no-referrer" alt="image-20200610171822381"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610171851381.png" referrerpolicy="no-referrer" alt="image-20200610171851381"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610172528337.png" referrerpolicy="no-referrer" alt="image-20200610172528337"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610172612481.png" referrerpolicy="no-referrer" alt="image-20200610172612481"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610172641550.png" referrerpolicy="no-referrer" alt="image-20200610172641550"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610172709951.png" referrerpolicy="no-referrer" alt="image-20200610172709951"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610172823454.png" referrerpolicy="no-referrer" alt="image-20200610172823454"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610172500391.png" referrerpolicy="no-referrer" alt="image-20200610172500391"></p><h3><a name="解释器interpreter）" class="md-header-anchor"></a><span>解释器（Interpreter）</span></h3><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">解释器：当Java虚拟机启动时会根据预定义的规范对应字节码采用逐行解释的方法执行，将每条字节码文件中的内容</span><span class="cm-string">"翻译"</span><span class="cm-variable">为对应平台的本地机器指令执行。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">解释器真正意义上所承担的角色就是一个运行时</span><span class="cm-string">"翻译者"</span><span class="cm-variable">，将字节码文件中的内容</span><span class="cm-string">"翻译"</span><span class="cm-variable">为对应平台的本地机器指令执行。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">当一条字节码指令被解释执行完成后，接着再根据PC寄存器中记录的下一条需要被执行的字节码指令执行解释操作。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 178px;"></div><div class="CodeMirror-gutters" style="display: none; height: 178px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610172944841.png" referrerpolicy="no-referrer" alt="image-20200610172944841"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610173314777.png" referrerpolicy="no-referrer" alt="image-20200610173314777"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610173359978.png" referrerpolicy="no-referrer" alt="image-20200610173359978"></p><h3><a name="jit编译器" class="md-header-anchor"></a><span>JIT编译器</span></h3><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">JIT</span>(<span class="cm-variable">Just</span> <span class="cm-variable">In</span> <span class="cm-variable">Time</span> <span class="cm-variable">Compiler</span>)<span class="cm-variable">编译器：</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">就是虚拟机将源代码直接编译成和本地机器平台相关的机器语言。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Java代码的执行分类：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">第一种是将源代码编译成字节码文件，然后在运行时通过解释器将字节码文件转为机器码执行。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">第二种是编译执行（直接编译成机器码）。现代虚拟机为了提高执行效率，会使用即时编译技术（JIT，Just</span> <span class="cm-variable">In</span> <span class="cm-variable">Time）将方法编译成机器码后再执行。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">HotSpot</span> <span class="cm-variable">JVM是目前市面上高性能虚拟机的代表作之一。它采用解释器与即时编译器并存的架构。在Java虚拟机运行时，解释器和即时编译器能够相互协作，各自取长补短，尽力去选择最合适的方式来权衡编译本地代码的时间和直接解释执行代码的时间。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">Hotspot</span> <span class="cm-variable">JVM当虚拟机启动的时候，解释器可以首先发挥作用，而不必等待即时编译器全部编译完成再执行，这样可以省去许多不必要的编译时间。并且随着程序运行时间的推移，即时编译器逐渐发挥作用，根据热点探测功能，将有价值的字节码编译为本地机器指令，以换取更高的程序执行效率。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 381px;"></div><div class="CodeMirror-gutters" style="display: none; height: 381px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610175039519.png" referrerpolicy="no-referrer" alt="image-20200610175039519"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610175248545.png" referrerpolicy="no-referrer" alt="image-20200610175248545"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610175535588.png" referrerpolicy="no-referrer" alt="image-20200610175535588"></p><h3><a name="编译器如何选择" class="md-header-anchor"></a><span>编译器如何选择</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610180027183.png" referrerpolicy="no-referrer" alt="image-20200610180027183"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610180320349.png" referrerpolicy="no-referrer" alt="image-20200610180320349"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610185757479.png" referrerpolicy="no-referrer" alt="image-20200610185757479"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610185821594.png" referrerpolicy="no-referrer" alt="image-20200610185821594"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610185851660.png" referrerpolicy="no-referrer" alt="image-20200610185851660"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610190426357.png" referrerpolicy="no-referrer" alt="image-20200610190426357"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610190502817.png" referrerpolicy="no-referrer" alt="image-20200610190502817"></p><h3><a name="设置程序执行器" class="md-header-anchor"></a><span>设置程序执行器</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610190607040.png" referrerpolicy="no-referrer" alt="image-20200610190607040"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610191609112.png" referrerpolicy="no-referrer" alt="image-20200610191609112"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610192209521.png" referrerpolicy="no-referrer" alt="image-20200610192209521"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610192411077.png" referrerpolicy="no-referrer" alt="image-20200610192411077"></p><h3><a name="总结-n304" class="md-header-anchor"></a><span>总结</span></h3><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">一般来讲，JIT编译出来的机器码性能比解释器高。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">C2编译启动时长比C1编译器慢，系统稳定执行以后，C2编译器执行速度远远快于C1编译器。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 51px;"></div><div class="CodeMirror-gutters" style="display: none; height: 51px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610192735977.png" referrerpolicy="no-referrer" alt="image-20200610192735977"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610193229040.png" referrerpolicy="no-referrer" alt="image-20200610193229040"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610193302221.png" referrerpolicy="no-referrer" alt="image-20200610193302221"></p><p>&nbsp;</p><h2><a name="5本地方法接口" class="md-header-anchor"></a><span>5、本地方法接口</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604105630189.png" referrerpolicy="no-referrer" alt="image-20200604105630189"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604105909717.png" referrerpolicy="no-referrer" alt="image-20200604105909717"></p><p><span>为什么要使用Native Method？</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">java使用起来非常方便，然而有些层次的任务用java实现起来不容易，或者我们对程序的效率很在意时，问题就来了。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span><span class="cm-variable">、与Java环境外交互：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">有时java应用需要与java外面的环境交互，这是本地方法存在的主要原因。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">你可以想想java需要与一些底层系统，如操作系统或某些硬件交换信息时的情况。本地方法正是这样一种交流机制：它为我们提供了一个非常简洁的接口，而且我们无法去了解java应用之外的繁琐的细节。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span><span class="cm-variable">、与操作系统交互：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">JVM支持着java语言本身和运行时库，它是java程序赖以生存的平台，它由一个解释器（解释字节码）和一些连接到本地代码的库组成。然而不管怎样，它毕竟不是一个完整的系统，它经常依赖于一些底层系统的支持。这些底层系统常常是强大的操作系统。通过使用本地方法，我们得以用java实现了jre的与底层系统的交互，甚至JVM的一些部分就是用c写的。还有，如果我们要使用一些java语言本身没有提供封装的操作系统的特性时，我们也需要使用本地方法。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span><span class="cm-variable">、Sun</span><span class="cm-string">'s java</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">sun的解释器是用c实现的，这使得它能像一些普通的c一样与外部交互。jre大部分是用java实现的，它也通过一些本地方法与外界交互。例如：类java</span>.<span class="cm-variable">lang</span>.<span class="cm-variable">Thread的setPriority</span>()<span class="cm-variable">方法是用java实现的，但是它实现调用的是该类里的本地方法setPriority0</span>()<span class="cm-variable">。这个本地方法时用c实现的，并被植入JVM内部，在Windows</span> <span class="cm-number">95</span><span class="cm-variable">的平台上，这个本地方法最终将调用win32</span> <span class="cm-variable">SetPriority（）API。这是一个本地方法的具体实现由JVM直接提供，更多的情况是本地方法由外部的动态链接库（external</span> <span class="cm-variable">dynamic</span> <span class="cm-variable">link</span> <span class="cm-variable">library</span>)<span class="cm-variable">提供，然后被JVM调用。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 507px;"></div><div class="CodeMirror-gutters" style="display: none; height: 507px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200604112052538.png" referrerpolicy="no-referrer" alt="image-20200604112052538"></p><h2><a name="6垃圾回收-garbage-collector" class="md-header-anchor"></a><span>6、垃圾回收 garbage collector</span></h2><p><span>chapter15代码</span></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611151917380.png" referrerpolicy="no-referrer" alt="image-20200611151917380"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611152102735.png" referrerpolicy="no-referrer" alt="image-20200611152102735"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611152206048.png" referrerpolicy="no-referrer" alt="image-20200611152206048"></p><h3><a name="1java的垃圾回收机制" class="md-header-anchor"></a><span>1.Java的垃圾回收机制</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611152349656.png" referrerpolicy="no-referrer" alt="image-20200611152349656"></p><p><a href='https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/toc.html' target='_blank' class='url'>https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/toc.html</a></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611153043596.png" referrerpolicy="no-referrer" alt="image-20200611153043596"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611153154985.png" referrerpolicy="no-referrer" alt="image-20200611153154985"></p><h3><a name="2垃圾回收相关的算法" class="md-header-anchor"></a><span>2.垃圾回收相关的算法</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611154341532.png" referrerpolicy="no-referrer" alt="image-20200611154341532"></p><h4><a name="1标记阶段引用计数算法" class="md-header-anchor"></a><span>1.标记阶段：引用计数算法</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611154729905.png" referrerpolicy="no-referrer" alt="image-20200611154729905"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611154926705.png" referrerpolicy="no-referrer" alt="image-20200611154926705"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611155153802.png" referrerpolicy="no-referrer" alt="image-20200611155153802"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611155529832.png" referrerpolicy="no-referrer" alt="image-20200611155529832"></p><h4><a name="2标记阶段可达性分析算法" class="md-header-anchor"></a><span>2.标记阶段：可达性分析算法</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611155700636.png" referrerpolicy="no-referrer" alt="image-20200611155700636"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611160004901.png" referrerpolicy="no-referrer" alt="image-20200611160004901"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611155825069.png" referrerpolicy="no-referrer" alt="image-20200611155825069"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611160325219.png" referrerpolicy="no-referrer" alt="image-20200611160325219"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611160434621.png" referrerpolicy="no-referrer" alt="image-20200611160434621"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611160614069.png" referrerpolicy="no-referrer" alt="image-20200611160614069"></p><h4><a name="3对象的finalization机制" class="md-header-anchor"></a><span>3.对象的finalization机制</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611160918264.png" referrerpolicy="no-referrer" alt="image-20200611160918264"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611161234005.png" referrerpolicy="no-referrer" alt="image-20200611161234005"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611161632324.png" referrerpolicy="no-referrer" alt="image-20200611161632324"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611161851773.png" referrerpolicy="no-referrer" alt="image-20200611161851773"></p><h4><a name="4mat与jprofiler的gc-roots溯源" class="md-header-anchor"></a><span>4.MAT与Jprofiler的GC Roots溯源</span></h4><p><span>gcroottest</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">MAT是Memory</span> <span class="cm-variable">Analyzer的简称，它是一款功能强大的Java堆内存分析器。用于查找内存泄漏以及查看内存消耗情况。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">MAT是基于Eclipse开发的，是一款免费的性能分析工具。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">Http</span>:<span class="cm-comment">//www.eclipse.org/mat/下载并使用MAT。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 102px;"></div><div class="CodeMirror-gutters" style="display: none; height: 102px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611163215691.png" referrerpolicy="no-referrer" alt="image-20200611163215691"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611163314820.png" referrerpolicy="no-referrer" alt="image-20200611163314820"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611165730170.png" referrerpolicy="no-referrer" alt="image-20200611165730170"></p><h4><a name="5清除阶段标记-清除算法" class="md-header-anchor"></a><span>5.清除阶段：标记-清除算法</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611170000461.png" referrerpolicy="no-referrer" alt="image-20200611170000461"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611170416560.png" referrerpolicy="no-referrer" alt="image-20200611170416560"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611170836412.png" referrerpolicy="no-referrer" alt="image-20200611170836412"></p><h4><a name="6清除阶段复制算法" class="md-header-anchor"></a><span>6.清除阶段：复制算法</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611171010707.png" referrerpolicy="no-referrer" alt="image-20200611171010707"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611171031168.png" referrerpolicy="no-referrer" alt="image-20200611171031168"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611172003999.png" referrerpolicy="no-referrer" alt="image-20200611172003999"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611172210841.png" referrerpolicy="no-referrer" alt="image-20200611172210841"></p><h4><a name="7清除阶段标记-压缩算法" class="md-header-anchor"></a><span>7.清除阶段：标记-压缩算法</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611172420570.png" referrerpolicy="no-referrer" alt="image-20200611172420570"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611172538652.png" referrerpolicy="no-referrer" alt="image-20200611172538652"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611172737515.png" referrerpolicy="no-referrer" alt="image-20200611172737515"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611173704441.png" referrerpolicy="no-referrer" alt="image-20200611173704441"></p><h4><a name="小结" class="md-header-anchor"></a><span>小结</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611174032911.png" referrerpolicy="no-referrer" alt="image-20200611174032911"></p><h4><a name="分代收集" class="md-header-anchor"></a><span>分代收集</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611181652739.png" referrerpolicy="no-referrer" alt="image-20200611181652739"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611181556594.png" referrerpolicy="no-referrer" alt="image-20200611181556594"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611181949710.png" referrerpolicy="no-referrer" alt="image-20200611181949710"></p><h4><a name="增量收集算法分区算法" class="md-header-anchor"></a><span>增量收集算法、分区算法</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611182123888.png" referrerpolicy="no-referrer" alt="image-20200611182123888"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611182155698.png" referrerpolicy="no-referrer" alt="image-20200611182155698"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611182245200.png" referrerpolicy="no-referrer" alt="image-20200611182245200"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611182316765.png" referrerpolicy="no-referrer" alt="image-20200611182316765"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611182403440.png" referrerpolicy="no-referrer" alt="image-20200611182403440"></p><h3><a name="1systemgc的理解" class="md-header-anchor"></a><span>1.System.gc()的理解</span></h3><p><span>chapter16</span></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611182611046.png" referrerpolicy="no-referrer" alt="image-20200611182611046"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="JAVA"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">System</span>.<span class="cm-variable">gc</span>();<span class="cm-comment">//提醒jvm的垃圾回收器执行gc,但是不确定是否马上执行gc</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">//与Runtime.getRuntime().gc();的作用一样。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">System</span>.<span class="cm-variable">runFinalization</span>();<span class="cm-comment">//强制调用使用引用的对象的finalize()方法</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-meta">@Override</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">protected</span> <span class="cm-variable-3">void</span> <span class="cm-def">finalize</span>() <span class="cm-keyword">throws</span> <span class="cm-variable">Throwable</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">super</span>.<span class="cm-variable">finalize</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-string">"SystemGCTest 重写了finalize()"</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintGCDetails</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 304px;"></div><div class="CodeMirror-gutters" style="display: none; height: 304px;"></div></div></div></pre><h3><a name="2内存溢出oom）" class="md-header-anchor"></a><span>2.内存溢出（OOM）</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612093222447.png" referrerpolicy="no-referrer" alt="image-20200612093222447"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612093710275.png" referrerpolicy="no-referrer" alt="image-20200612093710275"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612093755481.png" referrerpolicy="no-referrer" alt="image-20200612093755481"></p><p><span>内存泄漏（Memory Leak）</span></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612093946003.png" referrerpolicy="no-referrer" alt="image-20200612093946003"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612094401648.png" referrerpolicy="no-referrer" alt="image-20200612094401648"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612094852775.png" referrerpolicy="no-referrer" alt="image-20200612094852775"></p><h3><a name="3stop-the-world" class="md-header-anchor"></a><span>3.Stop The World</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612095331321.png" referrerpolicy="no-referrer" alt="image-20200612095331321"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612095410442.png" referrerpolicy="no-referrer" alt="image-20200612095410442"></p><h3><a name="4垃圾回收的并行与并发" class="md-header-anchor"></a><span>4.垃圾回收的并行与并发</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612100034481.png" referrerpolicy="no-referrer" alt="image-20200612100034481"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612100314684.png" referrerpolicy="no-referrer" alt="image-20200612100314684"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612100415930.png" referrerpolicy="no-referrer" alt="image-20200612100415930"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612100533437.png" referrerpolicy="no-referrer" alt="image-20200612100533437"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612100720356.png" referrerpolicy="no-referrer" alt="image-20200612100720356"></p><h3><a name="5安全点与安全区域" class="md-header-anchor"></a><span>5.安全点与安全区域</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612101024608.png" referrerpolicy="no-referrer" alt="image-20200612101024608"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612101247577.png" referrerpolicy="no-referrer" alt="image-20200612101247577"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612101317834.png" referrerpolicy="no-referrer" alt="image-20200612101317834"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612101552336.png" referrerpolicy="no-referrer" alt="image-20200612101552336"></p><h3><a name="6再谈引用" class="md-header-anchor"></a><span>6.再谈引用</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612102036079.png" referrerpolicy="no-referrer" alt="image-20200612102036079"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612102425117.png" referrerpolicy="no-referrer" alt="image-20200612102425117"></p><h4><a name="强引用" class="md-header-anchor"></a><span>强引用</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612102718709.png" referrerpolicy="no-referrer" alt="image-20200612102718709"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612102903456.png" referrerpolicy="no-referrer" alt="image-20200612102903456"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612102919498.png" referrerpolicy="no-referrer" alt="image-20200612102919498"></p><h4><a name="软引用" class="md-header-anchor"></a><span>软引用</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612103447625.png" referrerpolicy="no-referrer" alt="image-20200612103447625"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612103538901.png" referrerpolicy="no-referrer" alt="image-20200612103538901"></p><h4><a name="弱引用" class="md-header-anchor"></a><span>弱引用</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612104659891.png" referrerpolicy="no-referrer" alt="image-20200612104659891"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612104817390.png" referrerpolicy="no-referrer" alt="image-20200612104817390"></p><h4><a name="虚引用" class="md-header-anchor"></a><span>虚引用</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612105054754.png" referrerpolicy="no-referrer" alt="image-20200612105054754"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612105110235.png" referrerpolicy="no-referrer" alt="image-20200612105110235"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612110021959.png" referrerpolicy="no-referrer" alt="image-20200612110021959"></p><h3><a name="7垃圾回收器" class="md-header-anchor"></a><span>7、垃圾回收器</span></h3><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612114521530.png" referrerpolicy="no-referrer" alt="image-20200612114521530"></p><h4><a name="1gc分类与性能指标" class="md-header-anchor"></a><span>1.GC分类与性能指标</span></h4><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">垃圾收集器没有在规范中进行过多的规定，可以由不同的厂商、不同版本的JVM来实现。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">由于JDK的版本处于高速迭代过程中，因此Java发展至今已经衍生了众多的GC版本。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">从不同角度分析垃圾收集器，可以将GC分为不同的类型。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Java不同版本的新特性：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-number">1.</span><span class="cm-variable">语法层面：Lambda表达式、switch、自动装箱、自动拆箱、enum、泛型</span><span class="cm-operator">&lt;&gt;</span> <span class="cm-variable">等。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-number">2.</span><span class="cm-variable">API层面：Stream</span> <span class="cm-variable">API、新的日期时间、Optional、String、集合框架。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-number">3.</span><span class="cm-variable">底层优化：JVM的优化，GC的变化、元空间、静态域、字符串常量池等。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 203px;"></div><div class="CodeMirror-gutters" style="display: none; height: 203px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612111553363.png" referrerpolicy="no-referrer" alt="image-20200612111553363"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612111739453.png" referrerpolicy="no-referrer" alt="image-20200612111739453"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612111840430.png" referrerpolicy="no-referrer" alt="image-20200612111840430"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612112033103.png" referrerpolicy="no-referrer" alt="image-20200612112033103"></p><h5><a name="评估gc的性能指标" class="md-header-anchor"></a><span>评估GC的性能指标</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612112555371.png" referrerpolicy="no-referrer" alt="image-20200612112555371"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612112805821.png" referrerpolicy="no-referrer" alt="image-20200612112805821"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612112841242.png" referrerpolicy="no-referrer" alt="image-20200612112841242"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612113704812.png" referrerpolicy="no-referrer" alt="image-20200612113704812"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612113835271.png" referrerpolicy="no-referrer" alt="image-20200612113835271"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612113921268.png" referrerpolicy="no-referrer" alt="image-20200612113921268"></p><h4><a name="2不同的垃圾回收器概述" class="md-header-anchor"></a><span>2.不同的垃圾回收器概述</span></h4><p><span>垃圾收集机制是Java的招牌能力，极大地提高了开发效率。</span></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612114503098.png" referrerpolicy="no-referrer" alt="image-20200612114503098"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612114953128.png" referrerpolicy="no-referrer" alt="image-20200612114953128"></p><h5><a name="经典的垃圾收集器文档地址" class="md-header-anchor"></a><span>经典的垃圾收集器文档地址：</span></h5><p><a href='https://www.oracle.com/technetwork/java/javase/tech/memorymanagement-whitepaper-1-150020.pdf' target='_blank' class='url'>https://www.oracle.com/technetwork/java/javase/tech/memorymanagement-whitepaper-1-150020.pdf</a></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612115842093.png" referrerpolicy="no-referrer" alt="	"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612114521530.png" referrerpolicy="no-referrer" alt="image-20200612114521530"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612120406808.png" referrerpolicy="no-referrer" alt="image-20200612120406808"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612120521759.png" referrerpolicy="no-referrer" alt="image-20200612120521759"></p><h5><a name="查看默认的垃圾收集器-附参数设置）" class="md-header-anchor"></a><span>查看默认的垃圾收集器 （附：参数设置）</span></h5><p><span>chapter17</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintCommandLineFlags</span>:<span class="cm-variable">查看命令行相关参数（包含使用的垃圾收集器）</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">使用命令行指令：jinfo</span> <span class="cm-operator">-</span><span class="cm-variable">flag</span> <span class="cm-variable">相关垃圾回收器参数</span> <span class="cm-variable">进程ID</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">设置Serial回收器</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintCommandLineFlags</span> <span class="cm-operator">-</span><span class="cm-variable">XX：</span><span class="cm-operator">+</span><span class="cm-variable">UseSerialGC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">设置ParNew回收器</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintCommandLineFlags</span> <span class="cm-operator">-</span><span class="cm-variable">XX：</span><span class="cm-operator">+</span><span class="cm-variable">UseParNewGC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintCommandLineFlags</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseSerialGC</span>:<span class="cm-variable">表明新生代使用Serial</span> <span class="cm-variable">GC</span> <span class="cm-variable">，同时老年代使用Serial</span> <span class="cm-variable">Old</span> <span class="cm-variable">GC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseParNewGC：标明新生代使用ParNew</span> <span class="cm-variable">GC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseParallelGC</span>:<span class="cm-variable">表明新生代使用Parallel</span> <span class="cm-variable">GC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseParallelOldGC</span> : <span class="cm-variable">表明老年代使用</span> <span class="cm-variable">Parallel</span> <span class="cm-variable">Old</span> <span class="cm-variable">GC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-variable">说明：二者可以相互激活</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-operator">*</span> &nbsp;<span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseConcMarkSweepGC：表明老年代使用CMS</span> <span class="cm-variable">GC。同时，年轻代会触发对ParNew</span> <span class="cm-variable">的使用</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 482px;"></div><div class="CodeMirror-gutters" style="display: none; height: 482px;"></div></div></div></pre><h4><a name="3serial串行回收" class="md-header-anchor"></a><span>3.Serial：串行回收</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612121847533.png" referrerpolicy="no-referrer" alt="image-20200612121847533"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612122007118.png" referrerpolicy="no-referrer" alt="image-20200612122007118"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612122131861.png" referrerpolicy="no-referrer" alt="image-20200612122131861"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612122225295.png" referrerpolicy="no-referrer" alt="image-20200612122225295"></p><h4><a name="4parnew并行回" class="md-header-anchor"></a><span>4.ParNew：并行回</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612135010820.png" referrerpolicy="no-referrer" alt="image-20200612135010820"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612134814466.png" referrerpolicy="no-referrer" alt="image-20200612134814466"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612134929986.png" referrerpolicy="no-referrer" alt="image-20200612134929986"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612135044419.png" referrerpolicy="no-referrer" alt="image-20200612135044419"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612135453465.png" referrerpolicy="no-referrer" alt="image-20200612135453465"></p><h4><a name="5parallel吞吐量优先" class="md-header-anchor"></a><span>5.Parallel:吞吐量优先</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612140833746.png" referrerpolicy="no-referrer" alt="image-20200612140833746"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612141101103.png" referrerpolicy="no-referrer" alt="image-20200612141101103"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612141428551.png" referrerpolicy="no-referrer" alt="image-20200612141428551"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612141447582.png" referrerpolicy="no-referrer" alt="image-20200612141447582"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612141600968.png" referrerpolicy="no-referrer" alt="image-20200612141600968"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612142421601.png" referrerpolicy="no-referrer" alt="image-20200612142421601"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612142535257.png" referrerpolicy="no-referrer" alt="image-20200612142535257"></p><h4><a name="6cms低延迟" class="md-header-anchor"></a><span>6.CMS：低延迟</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612143245207.png" referrerpolicy="no-referrer" alt="image-20200612143245207"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612143825248.png" referrerpolicy="no-referrer" alt="image-20200612143825248"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612143918781.png" referrerpolicy="no-referrer" alt="image-20200612143918781"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612144103064.png" referrerpolicy="no-referrer" alt="image-20200612144103064"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612144314368.png" referrerpolicy="no-referrer" alt="image-20200612144314368"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612144558178.png" referrerpolicy="no-referrer" alt="image-20200612144558178"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612145003031.png" referrerpolicy="no-referrer" alt="image-20200612145003031"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612145211428.png" referrerpolicy="no-referrer" alt="image-20200612145211428"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612145301108.png" referrerpolicy="no-referrer" alt="image-20200612145301108"></p><h5><a name="设置参数" class="md-header-anchor"></a><span>设置参数</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612145841327.png" referrerpolicy="no-referrer" alt="image-20200612145841327"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612150512723.png" referrerpolicy="no-referrer" alt="image-20200612150512723"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612150746527.png" referrerpolicy="no-referrer" alt="image-20200612150746527"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612150819984.png" referrerpolicy="no-referrer" alt="image-20200612150819984"></p><h4><a name="7g1回收器区域划分代式" class="md-header-anchor"></a><span>7.G1回收器：区域划分代式</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612151207249.png" referrerpolicy="no-referrer" alt="image-20200612151207249"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612151537458.png" referrerpolicy="no-referrer" alt="image-20200612151537458"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612151840079.png" referrerpolicy="no-referrer" alt="image-20200612151840079"></p><h5><a name="优势" class="md-header-anchor"></a><span>优势</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612151908473.png" referrerpolicy="no-referrer" alt="image-20200612151908473"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612152710021.png" referrerpolicy="no-referrer" alt="image-20200612152710021"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612152830991.png" referrerpolicy="no-referrer" alt="image-20200612152830991"></p><h5><a name="缺点" class="md-header-anchor"></a><span>缺点</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612153241837.png" referrerpolicy="no-referrer" alt="image-20200612153241837"></p><h5><a name="设置参数-n492" class="md-header-anchor"></a><span>设置参数</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612154053218.png" referrerpolicy="no-referrer" alt="image-20200612154053218"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612154303785.png" referrerpolicy="no-referrer" alt="image-20200612154303785"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612154452144.png" referrerpolicy="no-referrer" alt="image-20200612154452144"></p><h5><a name="region分区" class="md-header-anchor"></a><span>Region分区</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612154539795.png" referrerpolicy="no-referrer" alt="image-20200612154539795"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612154639298.png" referrerpolicy="no-referrer" alt="image-20200612154639298"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612154722481.png" referrerpolicy="no-referrer" alt="image-20200612154722481"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612154816379.png" referrerpolicy="no-referrer" alt="image-20200612154816379"></p><h5><a name="g1回收器垃圾回收过程" class="md-header-anchor"></a><span>G1回收器垃圾回收过程</span></h5><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612154930759.png" referrerpolicy="no-referrer" alt="image-20200612154930759"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612182000967.png" referrerpolicy="no-referrer" alt="image-20200612182000967"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612182244517.png" referrerpolicy="no-referrer" alt="image-20200612182244517"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612182458369.png" referrerpolicy="no-referrer" alt="image-20200612182458369"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612182530066.png" referrerpolicy="no-referrer" alt="image-20200612182530066"></p><h4><a name="8总结" class="md-header-anchor"></a><span>8.总结</span></h4><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612182738614.png" referrerpolicy="no-referrer" alt="image-20200612182738614"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612182930891.png" referrerpolicy="no-referrer" alt="image-20200612182930891"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612183144227.png" referrerpolicy="no-referrer" alt="image-20200612183144227"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612183433144.png" referrerpolicy="no-referrer" alt="image-20200612183433144"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612183521918.png" referrerpolicy="no-referrer" alt="image-20200612183521918"></p><h4><a name="9gc日志分析" class="md-header-anchor"></a><span>9.GC日志分析</span></h4><p><span>chapter17</span></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612184019445.png" referrerpolicy="no-referrer" alt="image-20200612184019445"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612184112789.png" referrerpolicy="no-referrer" alt="image-20200612184112789"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612184604590.png" referrerpolicy="no-referrer" alt="image-20200612184604590"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612184637917.png" referrerpolicy="no-referrer" alt="image-20200612184637917"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612185114891.png" referrerpolicy="no-referrer" alt="image-20200612185114891"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612185405089.png" referrerpolicy="no-referrer" alt="image-20200612185405089"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612185604313.png" referrerpolicy="no-referrer" alt="image-20200612185604313"></p><p>&nbsp;</p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612185750288.png" referrerpolicy="no-referrer" alt="image-20200612185750288"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612185859793.png" referrerpolicy="no-referrer" alt="image-20200612185859793"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612190324639.png" referrerpolicy="no-referrer" alt="image-20200612190324639"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612190446935.png" referrerpolicy="no-referrer" alt="image-20200612190446935"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612190622487.png" referrerpolicy="no-referrer" alt="image-20200612190622487"></p><h5><a name="gc日志分析工具" class="md-header-anchor"></a><span>GC日志分析工具</span></h5><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">常用的日志分析工具有：GCViewer、GCEasy、GCHisto、GCLogViewer、Hpjmeter、garbagecat等。</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 51px;"></div><div class="CodeMirror-gutters" style="display: none; height: 51px;"></div></div></div></pre><p><span>新时期的Epsilon和Shenandoah垃圾回收器</span></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612191527105.png" referrerpolicy="no-referrer" alt="image-20200612191527105"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612191839526.png" referrerpolicy="no-referrer" alt="image-20200612191839526"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612192032239.png" referrerpolicy="no-referrer" alt="image-20200612192032239"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612192219395.png" referrerpolicy="no-referrer" alt="image-20200612192219395"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612192353220.png" referrerpolicy="no-referrer" alt="image-20200612192353220"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612192654104.png" referrerpolicy="no-referrer" alt="image-20200612192654104"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612192746391.png" referrerpolicy="no-referrer" alt="image-20200612192746391"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612192818101.png" referrerpolicy="no-referrer" alt="image-20200612192818101"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612192908626.png" referrerpolicy="no-referrer" alt="image-20200612192908626"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612193021127.png" referrerpolicy="no-referrer" alt="image-20200612193021127"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612193054592.png" referrerpolicy="no-referrer" alt="image-20200612193054592"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612193152124.png" referrerpolicy="no-referrer" alt="image-20200612193152124"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612193209278.png" referrerpolicy="no-referrer" alt="image-20200612193209278"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612193320738.png" referrerpolicy="no-referrer" alt="image-20200612193320738"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200612193400820.png" referrerpolicy="no-referrer" alt="image-20200612193400820"></p><h1><a name="1对象的实例化" class="md-header-anchor"></a><span>1.对象的实例化</span></h1><p><span>chapter10代码</span></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605185826301.png" referrerpolicy="no-referrer" alt="image-20200605185826301"></p><p><span>指针碰撞</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">如果内存是规整的，那么虚拟机将采用的是指针碰撞法（Bump</span> <span class="cm-variable">The</span> <span class="cm-variable">Pointer）来为对象分配内存。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-def">意思是所有用过的内存在一边，空闲的内存在另一边，中间放着一个指针作为分界点的指示器，分配内存就仅仅是把指针向空闲那边挪动一段与对象大小相等的距离罢了。如果垃圾收集器选择的是Serial、ParNew这种基于压缩算法的，虚拟机采用这种分配方式。一般使用带有compact</span>(<span class="cm-variable">整理</span>)<span class="cm-variable">过程的收集器时，使用指针碰撞。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 127px;"></div><div class="CodeMirror-gutters" style="display: none; height: 127px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611173452867.png" referrerpolicy="no-referrer" alt="image-20200611173452867"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605190532258.png" referrerpolicy="no-referrer" alt="image-20200605190532258"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605190819991.png" referrerpolicy="no-referrer" alt="image-20200605190819991"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605190839866.png" referrerpolicy="no-referrer" alt="image-20200605190839866"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605190859012.png" referrerpolicy="no-referrer" alt="image-20200605190859012"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200605190916925.png" referrerpolicy="no-referrer" alt="image-20200605190916925"></p><h2><a name="对象的内存分布" class="md-header-anchor"></a><span>对象的内存分布</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610143540973.png" referrerpolicy="no-referrer" alt="image-20200610143540973"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610143621125.png" referrerpolicy="no-referrer" alt="image-20200610143621125"></p><h2><a name="对象访问定位" class="md-header-anchor"></a><span>对象访问定位</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610144543093.png" referrerpolicy="no-referrer" alt="image-20200610144543093"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610144404928.png" referrerpolicy="no-referrer" alt="image-20200610144404928"></p><h3><a name="句柄访问" class="md-header-anchor"></a><span>句柄访问：</span></h3><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">好处：reference中存储稳定句柄地址，对象呗移动（垃圾收集时移动对象很普遍）时只会改变句柄中实例数据指针即可，reference本身不需要被修改。</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 51px;"></div><div class="CodeMirror-gutters" style="display: none; height: 51px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610144900605.png" referrerpolicy="no-referrer" alt="image-20200610144900605"></p><h3><a name="直接指针hotspot采用" class="md-header-anchor"></a><span>直接指针：Hotspot采用</span></h3><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">好处：节省空间，效率高。</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 25px;"></div><div class="CodeMirror-gutters" style="display: none; height: 25px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610145117540.png" referrerpolicy="no-referrer" alt="image-20200610145117540"></p><h1><a name="2直接内存direct-memory）" class="md-header-anchor"></a><span>2.直接内存（Direct Memory）</span></h1><p><span>chapter10代码</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">概述：</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">不是虚拟机运行时数据区的一部分，也不是《Java虚拟机规范》中定义的内存区域。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">直接内存是在Java堆外的、直接向系统申请的内存区间。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">来源于NIO，通过存在堆中的DirectByteBuffer操作Native内存</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">通常，访问直接内存的速度会优于Java堆。即读写性能高。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">因此出于性能考虑，读写频繁的场合可能会考虑使用直接内存。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">Java的NIO库允许Java程序使用直接内存，用于数据缓冲区。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">也可能导致OutOfMemoryError异常：direct</span> <span class="cm-variable">buffer</span> <span class="cm-variable">memory</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">由于直接内存在Java堆外，因此它的大小不会知己受限于</span><span class="cm-operator">-</span><span class="cm-variable">Xmx指定的最大堆大小，但是系统内存是有限的，Java堆和直接内存的总和依然受限于操作系统能给出的最大内存。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">缺点：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">分配回收成本较高。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">不受JVM内存回收管理</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">直接内存大小可以通过MaxDirectMemorySize设置</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">如果不指定，默认与堆的最大值</span><span class="cm-operator">-</span><span class="cm-variable">Xmx参数值一致。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 409px;"></div><div class="CodeMirror-gutters" style="display: none; height: 409px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610152127807.png" referrerpolicy="no-referrer" alt="image-20200610152127807"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610152256776.png" referrerpolicy="no-referrer" alt="image-20200610152256776"></p><h1><a name="3string" class="md-header-anchor"></a><span>3、String</span></h1><h2><a name="1string的基本特性" class="md-header-anchor"></a><span>1、String的基本特性</span></h2><p><span>chapter13代码</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">String：字符串，使用一对</span><span class="cm-string">""</span><span class="cm-variable">引起来表示。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-3">String</span> <span class="cm-variable">s1</span> <span class="cm-operator">=</span> <span class="cm-string">"att"</span>;<span class="cm-comment">//字面量的定义方式</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable-3">String</span> <span class="cm-variable">s2</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable-3">String</span>(<span class="cm-string">"hello"</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">String声明为final的，不可被继承</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">String实现类serializable接口</span>:<span class="cm-variable">表示字符串是支持序列化的。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">实现了Comparable接口：表示String可以比较大小</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">String在JDK8及以前内部定义了final</span> <span class="cm-variable-3">char</span>[] <span class="cm-variable">value用于存储字符串数据。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">JDK9时改成Byte</span>[]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-3">String</span>:<span class="cm-variable">代表不可变的字符序列。简称：不可变性。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">当对字符串重新赋值时，需要重写指定内存区域赋值</span> <span class="cm-variable">，不能使用原有的value进行赋值。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">当对现有的字符串进行连接操作时，也需要重新指定内存区域赋值，不能使用原有的value进行赋值。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-def">当调用String的replace</span>()<span class="cm-variable">方法修改指定字符或字符串时，也需要重新指定内存区域赋值，不能使用原有的value进行赋值。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">通过字面量的方式</span>(<span class="cm-variable">区别于new</span>)<span class="cm-variable">给一个字符串赋值，此时的字符串值声明在字符串常量池中。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">字符串常量池中时不会存储相同内容的字符串的。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 431px;"></div><div class="CodeMirror-gutters" style="display: none; height: 431px;"></div></div></div></pre><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610202605209.png" referrerpolicy="no-referrer" alt="image-20200610202605209"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610195610767.png" referrerpolicy="no-referrer" alt="image-20200610195610767"></p><h2><a name="2string的内存分配" class="md-header-anchor"></a><span>2、String的内存分配</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610203538816.png" referrerpolicy="no-referrer" alt="image-20200610203538816"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610203912916.png" referrerpolicy="no-referrer" alt="image-20200610203912916"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610204649774.png" referrerpolicy="no-referrer" alt="image-20200610204649774"></p><h2><a name="3string的基本操作" class="md-header-anchor"></a><span>3、String的基本操作</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610204735371.png" referrerpolicy="no-referrer" alt="image-20200610204735371"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610210055472.png" referrerpolicy="no-referrer" alt="image-20200610210055472"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200610210113913.png" referrerpolicy="no-referrer" alt="image-20200610210113913"></p><h2><a name="4字符串拼接操作" class="md-header-anchor"></a><span>4、字符串拼接操作</span></h2><p><span>Stringtest5.java</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span><span class="cm-variable">、常量与常量的拼接结果在常量池，原理是编译期优化</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span><span class="cm-variable">、常量池中不会存在相同内容的常量。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span><span class="cm-variable">、只要其中有一个是变量，结果就在堆中。变量拼接的原理是StringBuilder</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span><span class="cm-variable">、如果拼接的结果调用intern</span>()<span class="cm-variable">方法，则主动将常量池中还没有的字符串对象放入池中，并返回此对象地址。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 127px;"></div><div class="CodeMirror-gutters" style="display: none; height: 127px;"></div></div></div></pre><h2><a name="5intern的使用" class="md-header-anchor"></a><span>5、intern()的使用</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611103639158.png" referrerpolicy="no-referrer" alt="image-20200611103639158"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611110556359.png" referrerpolicy="no-referrer" alt="image-20200611110556359"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611111731579.png" referrerpolicy="no-referrer" alt="image-20200611111731579"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611111532079.png" referrerpolicy="no-referrer" alt="image-20200611111532079"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611111829391.png" referrerpolicy="no-referrer" alt="image-20200611111829391"></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">intern</span>()<span class="cm-variable">的效率测试</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-def">大的网站平台，需要内存中存储大量的字符串。比如社交网站，很多人都存储：北京市、海淀区等信息。这个时候如果字符串调用intern</span>()<span class="cm-variable">方法，就会明显降低内存的大小。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 76px;"></div><div class="CodeMirror-gutters" style="display: none; height: 76px;"></div></div></div></pre><h2><a name="6stringtable的垃圾回收" class="md-header-anchor"></a><span>6、StringTable的垃圾回收</span></h2><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611151137757.png" referrerpolicy="no-referrer" alt="image-20200611151137757"></p><h2><a name="7g1中的string去重操作" class="md-header-anchor"></a><span>7、G1中的String去重操作</span></h2><p><a href='http://openjdk.java.net/jeps/192' target='_blank' class='url'>http://openjdk.java.net/jeps/192</a></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611151300170.png" referrerpolicy="no-referrer" alt="image-20200611151300170"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611151516415.png" referrerpolicy="no-referrer" alt="image-20200611151516415"></p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200611151549492.png" referrerpolicy="no-referrer" alt="image-20200611151549492"></p><h1><a name="常见面试题" class="md-header-anchor"></a><span>常见面试题</span></h1><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">百度</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">三面：说一下jvm内存模型吧，有哪些区？分别干什么的？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">蚂蚁金服：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">java8的内存分代改进</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">JVM内存分哪几个区，每个区的作用是什么？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">一面：JVM内存分布</span><span class="cm-operator">/</span><span class="cm-variable">内存结构？栈和堆的区别？堆的结构？为什么两个survivor区？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">二面：Eden和Survivor的比例分配</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">二面：java对象头里有什么</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">小米：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">JVM内存分区，为什么要有新生代和老年代</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">字节跳动：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">二面：java的内存分区</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">二面：讲讲JVM运行时数据区</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">什么时候对象会进入老年代？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">京东：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">JVM的内存结构，Eden和Survivor比例。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">JVM内存为什么要分成新生代，老年代，持久代。新生代中为什么要分为Eden和Survivor。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">天猫：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">一面：JVM内存模型以及分区，需要详细到每个区放什么。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">一面：JVM的内存模型，java8做了什么修改</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">拼多多：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">JVM内存分哪几个区，每个区的作用是什么？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">美团：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">Java内存分配</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">JVM的永久代中会发生垃圾回收吗？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">一面：JVM内存分区，为什么要有新生代和老年代？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">对象在JVM中时怎么存储的？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">对象头信息里面有哪些东西？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1217px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1217px;"></div></div></div></pre><p>&nbsp;</p><h1><a name="二字节码与类的加载篇" class="md-header-anchor"></a><span>二、字节码与类的加载篇</span></h1><p>&nbsp;</p><h1><a name="三性能监控与调优篇" class="md-header-anchor"></a><span>三、性能监控与调优篇</span></h1><p>&nbsp;</p><p><img src="D:\Program Files\Typora\my_typora\image\jvm\image-20200526135504460.png" referrerpolicy="no-referrer" alt="image-20200526135504460"></p></div>
</body>
</html>